113232|sockets.examples|23|1379322711|Anonymous|VGhlIHZhcmlhYmxlICRpbiBpbiBUQ1AgY2xpZW50IGV4YW1wZSByZWFsbHkgbmVlZHMgdG8gZW5kIHdpdGggJ1xuJyBvciBvdGhlcndpc2UgaXQgZG9lc24ndCBmaXJlIHRoZSByZWFkIGV2ZW50IGluIHRoZSBzZXJ2ZXIgc2lkZSAoYXQgbGVhc3QgaW4gbXkgRGVscGhpIHByb2dyYW0pLg==|3|10
112001|sockets.examples|23|1366498455|silverwatersask at hotmail dot com|V29uZGVyIGlmIHNvbWVvbmUgY291bGQgdHJhbnNsYXRlIHRoaXMgdG8gRW5nbGlzaC4=|7|23
109888|sockets.examples|57|1346354751|javier,javiern at gmail dot com|WW91IGNhbiBlYXNpbHkgZXh0ZW5kIHRoZSBmaXJzdCBleGFtcGxlIHRvIGhhbmRsZSBhbnkgbnVtYmVyIG9mIGNvbm5lY3Rpb25zIGluc3RlYWQgb2YganN1dCBvbmUKCiMhL3Vzci9iaW4vZW52IHBocAo8P3BocAplcnJvcl9yZXBvcnRpbmcoRV9BTEwpOwoKLyogUGVybWl0aXIgYWwgc2NyaXB0IGVzcGVyYXIgcGFyYSBjb25leGlvbmVzLiAqLwpzZXRfdGltZV9saW1pdCgwKTsKCi8qIEFjdGl2YXIgZWwgdm9sY2FkbyBkZSBzYWxpZGEgaW1wbMOtY2l0bywgYXPDrSB2ZXJlbW9zIGxvIHF1ZSBlc3RhbW8gb2J0ZW5pZW5kbwogKiBtaWVudHJhcyBsbGVnYS4gKi8Kb2JfaW1wbGljaXRfZmx1c2goKTsKCiRhZGRyZXNzID0gJzEyNy4wLjAuMSc7CiRwb3J0ID0gMTAwMDA7CgppZiAoKCRzb2NrID0gc29ja2V0X2NyZWF0ZShBRl9JTkVULCBTT0NLX1NUUkVBTSwgU09MX1RDUCkpID09PSBmYWxzZSkgewogICAgZWNobyAic29ja2V0X2NyZWF0ZSgpIGZhbGzDszogcmF6w7NuOiAiIC4gc29ja2V0X3N0cmVycm9yKHNvY2tldF9sYXN0X2Vycm9yKCkpIC4gIlxuIjsKfQoKaWYgKHNvY2tldF9iaW5kKCRzb2NrLCAkYWRkcmVzcywgJHBvcnQpID09PSBmYWxzZSkgewogICAgZWNobyAic29ja2V0X2JpbmQoKSBmYWxsw7M6IHJhesOzbjogIiAuIHNvY2tldF9zdHJlcnJvcihzb2NrZXRfbGFzdF9lcnJvcigkc29jaykpIC4gIlxuIjsKfQoKaWYgKHNvY2tldF9saXN0ZW4oJHNvY2ssIDUpID09PSBmYWxzZSkgewogICAgZWNobyAic29ja2V0X2xpc3RlbigpIGZhbGzDszogcmF6w7NuOiAiIC4gc29ja2V0X3N0cmVycm9yKHNvY2tldF9sYXN0X2Vycm9yKCRzb2NrKSkgLiAiXG4iOwp9CgovL2NsaWVudHMgYXJyYXkKJGNsaWVudHMgPSBhcnJheSgpOwoKZG8gewogICAgJHJlYWQgPSBhcnJheSgpOwogICAgJHJlYWRbXSA9ICRzb2NrOwogICAgCiAgICAkcmVhZCA9IGFycmF5X21lcmdlKCRyZWFkLCRjbGllbnRzKTsKICAgIAogICAgLy8gU2V0IHVwIGEgYmxvY2tpbmcgY2FsbCB0byBzb2NrZXRfc2VsZWN0CiAgICBpZihzb2NrZXRfc2VsZWN0KCRyZWFkLCR3cml0ZSA9IE5VTEwsICRleGNlcHQgPSBOVUxMLCAkdHZfc2VjID0gNSkgPCAxKQogICAgewogICAgICAgIC8vCVNvY2tldFNlcnZlcjo6ZGVidWcoIlByb2JsZW0gYmxvY2tpbmcgc29ja2V0X3NlbGVjdD8iKTsKICAgICAgICBjb250aW51ZTsKICAgIH0KICAgIAogICAgLy8gSGFuZGxlIG5ldyBDb25uZWN0aW9ucwogICAgaWYgKGluX2FycmF5KCRzb2NrLCAkcmVhZCkpIHsgICAgICAgIAogICAgICAgIAogICAgICAgIGlmICgoJG1zZ3NvY2sgPSBzb2NrZXRfYWNjZXB0KCRzb2NrKSkgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIGVjaG8gInNvY2tldF9hY2NlcHQoKSBmYWxsw7M6IHJhesOzbjogIiAuIHNvY2tldF9zdHJlcnJvcihzb2NrZXRfbGFzdF9lcnJvcigkc29jaykpIC4gIlxuIjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgICRjbGllbnRzW10gPSAkbXNnc29jazsKICAgICAgICAka2V5ID0gYXJyYXlfa2V5cygkY2xpZW50cywgJG1zZ3NvY2spOwogICAgICAgIC8qIEVudmlhciBpbnN0cnVjY2lvbmVzLiAqLwogICAgICAgICRtc2cgPSAiXG5CaWVudmVuaWRvIGFsIFNlcnZpZG9yIERlIFBydWViYSBkZSBQSFAuIFxuIiAuCiAgICAgICAgIlVzdGVkIGVzIGVsIGNsaWVudGUgbnVtZXJvOiB7JGtleVswXX1cbiIgLgogICAgICAgICJQYXJhIHNhbGlyLCBlc2NyaWJhICdxdWl0Jy4gUGFyYSBjZXJyYXIgZWwgc2Vydmlkb3IgZXNjcmliYSAnc2h1dGRvd24nLlxuIjsKICAgICAgICBzb2NrZXRfd3JpdGUoJG1zZ3NvY2ssICRtc2csIHN0cmxlbigkbXNnKSk7CiAgICAgICAgCiAgICB9CiAgICAKICAgIC8vIEhhbmRsZSBJbnB1dAogICAgZm9yZWFjaCAoJGNsaWVudHMgYXMgJGtleSA9PiAkY2xpZW50KSB7IC8vIGZvciBlYWNoIGNsaWVudCAgICAgICAgCiAgICAgICAgaWYgKGluX2FycmF5KCRjbGllbnQsICRyZWFkKSkgewogICAgICAgICAgICBpZiAoZmFsc2UgPT09ICgkYnVmID0gc29ja2V0X3JlYWQoJGNsaWVudCwgMjA0OCwgUEhQX05PUk1BTF9SRUFEKSkpIHsKICAgICAgICAgICAgICAgIGVjaG8gInNvY2tldF9yZWFkKCkgZmFsbMOzOiByYXrDs246ICIgLiBzb2NrZXRfc3RyZXJyb3Ioc29ja2V0X2xhc3RfZXJyb3IoJGNsaWVudCkpIC4gIlxuIjsKICAgICAgICAgICAgICAgIGJyZWFrIDI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCEkYnVmID0gdHJpbSgkYnVmKSkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCRidWYgPT0gJ3F1aXQnKSB7CiAgICAgICAgICAgICAgICB1bnNldCgkY2xpZW50c1ska2V5XSk7CiAgICAgICAgICAgICAgICBzb2NrZXRfY2xvc2UoJGNsaWVudCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoJGJ1ZiA9PSAnc2h1dGRvd24nKSB7CiAgICAgICAgICAgICAgICBzb2NrZXRfY2xvc2UoJGNsaWVudCk7CiAgICAgICAgICAgICAgICBicmVhayAyOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0YWxrYmFjayA9ICJDbGllbnRlIHska2V5fTogVXN0ZWQgZGlqbyAnJGJ1ZicuXG4iOwogICAgICAgICAgICBzb2NrZXRfd3JpdGUoJGNsaWVudCwgJHRhbGtiYWNrLCBzdHJsZW4oJHRhbGtiYWNrKSk7CiAgICAgICAgICAgIGVjaG8gIiRidWZcbiI7CiAgICAgICAgfQogICAgICAgIAogICAgfSAgICAgICAgCn0gd2hpbGUgKHRydWUpOwoKc29ja2V0X2Nsb3NlKCRzb2NrKTsKPz4=|13|10
