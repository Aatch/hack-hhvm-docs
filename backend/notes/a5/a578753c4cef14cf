47432|function.ldap-first-reference|0|1100577389|sami at sipponen dot com|SG9wZWZ1bGx5IHRoZSBjb2RlIGJlbG93IGhlbHAgeW91IHRvIGxvb3AgdGhyb3VnaCByZWZlcmVuY2VzIHdpdGggTERBUDMgc2VydmVycy4gSXQgdG9vayBtZSBhIHNpZ25pZmljYW50IGFtb3VudCBvZiB0aW1lIHRvIGZpZ3VyZSBvdXQgaG93IHRoaXMgdGhpbmcgd29ya3MgYW5kIG5vdyBJIGhhdmUgc3VjY2Vzc2Z1bGx5IHVzZWQgdGhpcyB3aXRoIEFjdGl2ZSBEaXJlY3RvcnkgdG8gbG9vcCB0aHJvdWdoIHNldmVyaWFsIHN1YmRvbWFpbnMuCgpTcGVjaWFsIHRoYW5rcyB0byBTdGlnIFZlbmFhcyB3aG8gaGVscGVkIG1lIHRvIGdldCBzdGFydGVkLiAodGhlIG9yaWdpbmFsIHByb2JsZW0gd2FzIHRoYXQgbGRhcF9wYXJzZV9yZWZlcmVuY2UgZnVuY3Rpb24gd2FzIG1pc3NpbmcgaW4gV2luZG93cyBidWlsZHMuIEF0IGxlYXN0IGl0IHdpbGwgbm93IHdvcmsgd2l0aCBXaW5kb3dzIFBIUCB2ZXJzaW9ucyA1LjEuMC1ERVYgYW5kIGhpZ2hlciBhZnRlciBJIG1hZGUgYSBidWcgcmVwb3J0KQoKZnVuY3Rpb24gY3Jhd2xSZWZzKCR1c2VyLCAkcGFzc3csICRob3N0LCAkZG4sICRwb3J0LCAkZmlsdGVyKSB7CgogIC8vQ3JlYXRlIHRoZSBiYXNpYyBjb25uZWN0aW9uIGZvciBmZXRjaGluZyByZWZlcnJhbHMKICAkYWRDb25uID0gbGRhcF9jb25uZWN0KCRob3N0LCAkcG9ydCkgb3IgZGllKCJTeXN0ZW0gY291bGRuJ3QgY29ubmVjdCEiKTsKICBsZGFwX3NldF9vcHRpb24oJGFkQ29ubiwgTERBUF9PUFRfUFJPVE9DT0xfVkVSU0lPTiwgMykgb3IgZGllICgiU3lzdGVtIGNvdWxkbid0IG1ha2UgZmlyc3QgcHJvdG9jb2wgb3B0aW9uIHNldHRpbmchIik7CiAgbGRhcF9zZXRfb3B0aW9uKCRhZENvbm4sIExEQVBfT1BUX1JFRkVSUkFMUywgMCkgb3IgZGllICgiU3lzdGVtIGNvdWxkbid0IG1ha2Ugc2Vjb25kIHByb3RvY29sIG9wdGlvbiBzZXR0aW5nISIpOwogICRiZCA9IGxkYXBfYmluZCgkYWRDb25uLCAkdXNlciwgJHBhc3N3KSBvciBkaWUgKCJTeXN0ZW0gY291bGRuJ3QgYmluZCB0aGUgY29ubmVjdGlvbiEiKTsKICAkc2VhcmNoID0gbGRhcF9zZWFyY2goJGFkQ29ubiwgJGRuLCAkZmlsdGVyKTsKCiAgLy9GaW5kIHJlZmVycmFscwogICRyZWYgPSBsZGFwX2ZpcnN0X3JlZmVyZW5jZSgkYWRDb25uLCAkc2VhcmNoKTsKICB3aGlsZSAoJHJlZikgewogICAgaWYgKGxkYXBfcGFyc2VfcmVmZXJlbmNlKCRhZENvbm4sICRyZWYsICRyZWZlcnJhbHMpKSB7CiAgICAgIHdoaWxlICgkcmVmZXJyYWwgPSBhcnJheV9zaGlmdCgkcmVmZXJyYWxzKSkgewogICAgICAgIGVjaG8gJHJlZmVycmFsIC4gIjxicj5cbiI7CiAgICAgIH0KICAgIH0KICAkcmVmID0gbGRhcF9uZXh0X3JlZmVyZW5jZSgkYWRDb25uLCAkcmVmKTsKfQ==||
